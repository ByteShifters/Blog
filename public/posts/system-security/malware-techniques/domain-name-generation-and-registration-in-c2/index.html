<!DOCTYPE html>
<html lang="en-us"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">Domain Generation Algorithms and Automatic Domain Registration in C2 | ByteShifters</title>
<meta property="og:title" content="Domain Generation Algorithms and Automatic Domain Registration in C2 | ByteShifters" />
<meta name="twitter:title" content="Domain Generation Algorithms and Automatic Domain Registration in C2 | ByteShifters" />
<meta itemprop="name" content="Domain Generation Algorithms and Automatic Domain Registration in C2 | ByteShifters" />
<meta name="application-name" content="Domain Generation Algorithms and Automatic Domain Registration in C2 | ByteShifters" />
<meta property="og:site_name" content="" />

<meta name="description" content="">
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />





    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2024-10-04T00:00:00Z />
    <meta property="article:published_time" content=2024-10-04T00:00:00Z />
    <meta property="og:url" content="https://byteshifters.com/posts/system-security/malware-techniques/domain-name-generation-and-registration-in-c2/" />

    
    <meta property="og:article:author" content="ByteShifters" />
    <meta property="article:author" content="ByteShifters" />
    <meta name="author" content="ByteShifters" />
    
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "Domain Generation Algorithms and Automatic Domain Registration in C2",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2024-10-04",
        "description": "",
        "wordCount":  714 ,
        "mainEntityOfPage": "True",
        "dateModified": "2024-10-04",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "ByteShifters"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.122.0">

    
    <meta property="og:title" content="Domain Generation Algorithms and Automatic Domain Registration in C2" />
<meta property="og:description" content="Domain Generation Algorithms and Automatic Domain Registration Domain Generation Algorithms (DGAs) are critical tools used in various applications, including both legitimate and malicious domains. This blog post discusses how DGAs function and demonstrates how to automatically register the generated domains using the Namecheap API.
What is a Domain Generation Algorithm (DGA)? A Domain Generation Algorithm (DGA) is a technique used primarily in malware to generate domain names that are used for command and control (C2) operations." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://byteshifters.com/posts/system-security/malware-techniques/domain-name-generation-and-registration-in-c2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-10-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-10-04T00:00:00+00:00" />



    
    <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Domain Generation Algorithms and Automatic Domain Registration in C2"/>
<meta name="twitter:description" content="Domain Generation Algorithms and Automatic Domain Registration Domain Generation Algorithms (DGAs) are critical tools used in various applications, including both legitimate and malicious domains. This blog post discusses how DGAs function and demonstrates how to automatically register the generated domains using the Namecheap API.
What is a Domain Generation Algorithm (DGA)? A Domain Generation Algorithm (DGA) is a technique used primarily in malware to generate domain names that are used for command and control (C2) operations."/>


    
    <link rel="icon" type="image/png+xml" href="/icons/logo32.png">

    <link rel="canonical" href="https://byteshifters.com/posts/system-security/malware-techniques/domain-name-generation-and-registration-in-c2/">
    <link href="/style.min.a65edcf99b5d9c11dd8dc9c13f2e80eec76933d8449c8579cefe3c64191b71d4.css" rel="stylesheet">
    <link href="/code-highlight.min.3dea1c7a362e3a7df3392c75d19c1efa95b2e82aa030c322a07a6caf50cb8e9a.css" rel="stylesheet">

    
    <link rel="icon" type="image/png+xml" href="/icons/logo32.png">
    
    
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/logo32.png">
    




<link rel="manifest" href="https://byteshifters.com/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#cccccc">

    
    <link rel="icon" type="image/png"  sizes="32x32" href="/icons/logo32.png">

</head>
<body data-theme = "" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://byteshifters.com/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/contact/">
                        Contact
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">Domain Generation Algorithms and Automatic Domain Registration in C2</h1>
                
                
                <div class="post-meta">
                    <time datetime="2024-10-04T00:00:00&#43;00:00" itemprop="datePublished"> Oct 4, 2024 </time>
                </div>
                
                
                <div class="tags-list"><a href="https://byteshifters.com/tags/system-security/">#System Security</a>
                            <a href="https://byteshifters.com/tags/low-level/">#Low level</a>
                            <a href="https://byteshifters.com/tags/rootkits/">#Rootkits</a>
                            <a href="https://byteshifters.com/tags/malware/">#Malware</a>
                            <a href="https://byteshifters.com/tags/c2/">#C2</a>
                            </div>
            </header>
            
    
    <details class="toc" ZgotmplZ>
        <summary><b></b></summary>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-a-domain-generation-algorithm-dga">What is a Domain Generation Algorithm (DGA)?</a>
      <ul>
        <li><a href="#how-dgas-work">How DGAs Work</a></li>
      </ul>
    </li>
    <li><a href="#implementation-of-dga-in-go">Implementation of DGA in Go</a>
      <ul>
        <li><a href="#code-for-domain-generation">Code for Domain Generation</a></li>
        <li><a href="#domain-generation-logic">Domain Generation Logic</a></li>
      </ul>
    </li>
    <li><a href="#automatic-domain-registration-with-namecheap-api">Automatic Domain Registration with Namecheap API</a>
      <ul>
        <li><a href="#code-for-automatic-domain-registration">Code for Automatic Domain Registration</a></li>
        <li><a href="#integrating-domain-generation-and-registration">Integrating Domain Generation and Registration</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a>
      <ul>
        <li><a href="#important-considerations">Important Considerations</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </details>
            <div class="page-content">
                <h1 id="domain-generation-algorithms-and-automatic-domain-registration">Domain Generation Algorithms and Automatic Domain Registration</h1>
<p>Domain Generation Algorithms (DGAs) are critical tools used in various applications, including both legitimate and malicious domains. This blog post discusses how DGAs function and demonstrates how to automatically register the generated domains using the Namecheap API.</p>
<h2 id="what-is-a-domain-generation-algorithm-dga">What is a Domain Generation Algorithm (DGA)?</h2>
<p>A Domain Generation Algorithm (DGA) is a technique used primarily in malware to generate domain names that are used for command and control (C2) operations. These algorithms can produce a large number of domain names dynamically, making it difficult for security systems to block them.</p>
<h3 id="how-dgas-work">How DGAs Work</h3>
<ol>
<li><strong>Input Parameters</strong>: DGAs typically take in various parameters such as a seed, date, and suffix.</li>
<li><strong>Random Generation</strong>: Using these parameters, the algorithm generates pseudo-random domain names.</li>
<li><strong>Domain Construction</strong>: The final domain name is constructed by combining components derived from hashing and randomization.</li>
</ol>
<h2 id="implementation-of-dga-in-go">Implementation of DGA in Go</h2>
<p>Below is an implementation of a DGA in Go that generates domain names based on a given base domain, seed, and suffix.</p>
<h3 id="code-for-domain-generation">Code for Domain Generation</h3>
<pre tabindex="0"><code>package main

import (
	&#34;dga-project/pkg/dga&#34;
	&#34;fmt&#34;
	&#34;os&#34;
	&#34;time&#34;
)

func main() {
	if len(os.Args) &lt; 4 {
		fmt.Println(&#34;Usage: go run ./cmd/dga/ &lt;domain.com&gt; &lt;seed&gt; &lt;suffix&gt;&#34;)
		os.Exit(1)
	}

	baseDomain := os.Args[1]
	seed := os.Args[2]
	suffix := os.Args[3]

	currentDate := time.Now()

	domains := dga.GenerateDomains(baseDomain, seed, suffix, currentDate, 20)
	for _, domain := range domains {
		fmt.Println(&#34;Generated Domain:&#34;, domain)
	}
}
</code></pre><h3 id="domain-generation-logic">Domain Generation Logic</h3>
<p>The domain generation logic can be found in the <code>dga</code> package. Here&rsquo;s the code:</p>
<pre tabindex="0"><code>package dga

import (
	&#34;crypto/sha256&#34;
	&#34;encoding/hex&#34;
	&#34;fmt&#34;
	&#34;math/rand&#34;
	&#34;time&#34;
)

func GenerateDomains(baseDomain string, seed string, suffix string, date time.Time, count int) []string {
	var domains []string

	dateString := date.Format(&#34;20060102&#34;)

	rand.Seed(time.Now().UnixNano())

	for i := 0; i &lt; count; i++ {
		randomComponent := rand.Intn(1000000)
		hashInput := fmt.Sprintf(&#34;%s%s%d%d&#34;, seed, dateString, i, randomComponent)
		hashedValue := sha256.Sum256([]byte(hashInput))
		hashString := hex.EncodeToString(hashedValue[:])

		prefix := hashString[0:6]
		middle := hashString[6:12]

		domainName := fmt.Sprintf(&#34;%s.%s.%s.%s&#34;, prefix, middle, suffix, baseDomain)
		domains = append(domains, domainName)
	}

	return domains
}
</code></pre><h2 id="automatic-domain-registration-with-namecheap-api">Automatic Domain Registration with Namecheap API</h2>
<p>To register the generated domains automatically, we can use the Namecheap API. Below is the implementation for domain registration.</p>
<h3 id="code-for-automatic-domain-registration">Code for Automatic Domain Registration</h3>
<p>This code is placed in the <code>autoregister</code> package:</p>
<pre tabindex="0"><code>package autoregister

import (
	&#34;bytes&#34;
	&#34;encoding/json&#34;
	&#34;fmt&#34;
	&#34;io/ioutil&#34;
	&#34;net/http&#34;
)

const (
	apiUrl   = &#34;https://api.namecheap.com/v1/domains/create&#34;
	apiUser  = &#34;YOUR_API_USER&#34;
	apiKey   = &#34;YOUR_API_KEY&#34;
	userName = &#34;YOUR_USER_NAME&#34;
	clientIp = &#34;YOUR_CLIENT_IP&#34;
)

type DomainRegistrationRequest struct {
	ApiUser    string `json:&#34;ApiUser&#34;`
	ApiKey     string `json:&#34;ApiKey&#34;`
	UserName   string `json:&#34;UserName&#34;`
	ClientIp   string `json:&#34;ClientIp&#34;`
	DomainName string `json:&#34;DomainName&#34;`
	Years      int    `json:&#34;Years&#34;`
	AddOns     string `json:&#34;AddOns&#34;`
}

type DomainRegistrationResponse struct {
	Command string `json:&#34;Command&#34;`
	Status  string `json:&#34;Status&#34;`
}

func RegisterDomain(domain string, years int) {
	request := DomainRegistrationRequest{
		ApiUser:    apiUser,
		ApiKey:     apiKey,
		UserName:   userName,
		ClientIp:   clientIp,
		DomainName: domain,
		Years:      years,
		AddOns:     &#34;&#34;, // Optional, e.g., &#34;WhoisGuard&#34;
	}

	jsonData, err := json.Marshal(request)
	if err != nil {
		fmt.Println(&#34;Error marshalling request:&#34;, err)
		return
	}

	resp, err := http.Post(apiUrl, &#34;application/json&#34;, bytes.NewBuffer(jsonData))
	if err != nil {
		fmt.Println(&#34;Error sending request:&#34;, err)
		return
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		fmt.Println(&#34;Error: Received status code&#34;, resp.StatusCode)
		return
	}

	body, _ := ioutil.ReadAll(resp.Body)

	var response DomainRegistrationResponse
	if err := json.Unmarshal(body, &amp;response); err != nil {
		fmt.Println(&#34;Error unmarshalling response:&#34;, err)
		return
	}

	fmt.Printf(&#34;Domain Registration Status for %s: %s\n&#34;, domain, response.Status)
}
</code></pre><h3 id="integrating-domain-generation-and-registration">Integrating Domain Generation and Registration</h3>
<p>Finally, integrate both functionalities in the <code>cmd/dga/main.go</code> file:</p>
<pre tabindex="0"><code>package main

import (
	&#34;dga-project/pkg/autoregister&#34;
	&#34;dga-project/pkg/dga&#34;
	&#34;fmt&#34;
	&#34;os&#34;
	&#34;time&#34;
)

func main() {
	if len(os.Args) &lt; 4 {
		fmt.Println(&#34;Usage: go run ./cmd/dga/ &lt;domain.com&gt; &lt;seed&gt; &lt;suffix&gt;&#34;)
		os.Exit(1)
	}

	baseDomain := os.Args[1]
	seed := os.Args[2]
	suffix := os.Args[3]

	currentDate := time.Now()

	domains := dga.GenerateDomains(baseDomain, seed, suffix, currentDate, 20)
	for _, domain := range domains {
		fmt.Println(&#34;Generated Domain:&#34;, domain)
		autoregister.RegisterDomain(domain, 1)
	}
}
</code></pre><h2 id="summary">Summary</h2>
<p>This blog post illustrated how to implement a Domain Generation Algorithm (DGA) in Go and how to automate the registration of the generated domains using the Namecheap API. This dual approach can be applied in various domains, from cybersecurity research to legitimate business operations.</p>
<h3 id="important-considerations">Important Considerations</h3>
<ul>
<li><strong>API Credentials</strong>: Ensure you replace the placeholders for <code>apiUser</code>, <code>apiKey</code>, <code>userName</code>, and <code>clientIp</code> with your actual Namecheap account details.</li>
<li><strong>Costs</strong>: Be mindful of the costs associated with domain registration.</li>
<li><strong>Legal Compliance</strong>: Use this technology responsibly and ensure compliance with all relevant laws and regulations.</li>
</ul>
<p>Feel free to reach out if you have any questions or need further clarification on any of the topics discussed!</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/ByteShifters" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://twitter.com/ByteShifters" target="_blank" rel="noopener noreferrer me"
    title="Twitter">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
    </path>
</svg>
</a>
<a href="https://instagram.com/ByteShifters" target="_blank" rel="noopener noreferrer me"
    title="Instagram">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
    <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
    <line x1="17.5" y1="6.5" x2="17.5" y2="6.5"></line>
</svg>
</a>
<a href="mailto:us@byteshifters.com" target="_blank" rel="noopener noreferrer me"
    title="Email">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 21" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
    <polyline points="22,6 12,13 2,6"></polyline>
</svg>
</a>
<a href="index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        
        byteshifters.com
        
    </small>
</footer><a href="#" title="" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    






    
    <script src="https://byteshifters.com/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
